import 'package:demo_movies_map_profile/common/db/features/categories_data_base/dto/categories_base_dto.dart';import 'package:sqflite/sqflite.dart';import '../../../data_base/data_base.dart';import '../../../data_base/tables.dart';class CategoriesBaseDataBaseImpl {  final DataBaseLocal _dataBaseLocal;  CategoriesBaseDataBaseImpl(this._dataBaseLocal);  Future<List<CategoriesBaseDto>> getAllCategories() async {    final db = await _dataBaseLocal.createDatabase();    final List<Map<String, dynamic>> maps =        await db.query(categoriesTable, orderBy: "$categoriesIdentifier ASC");    final checkPoints = List.generate(maps.length, (counter) {      return CategoriesBaseDto(        identifier:            int.tryParse(maps[counter][categoriesIdentifier].toString()) ?? 0,        name: maps[counter][categoriesName].toString(),      );    });    return checkPoints;  }  Future<bool> insertCategories(List<CategoriesBaseDto> list) async {    final db = await _dataBaseLocal.createDatabase();    await db.transaction((txn) async {      Batch batch = txn.batch();      batch.delete(categoriesTable);      for (var item in list) {        final query =            'INSERT INTO $categoriesTable($categoriesIdentifier, $categoriesName) '            'VALUES(${item.identifier}, "${item.name}" )';        batch.rawInsert(query);      }      batch.commit(noResult: true);    });    return true;  }}